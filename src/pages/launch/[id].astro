---
import Layout from '../../layouts/Layout.astro';
import { type Doc, type APISpaceXAPIResponse } from '../../types/api';

const { id } = Astro.params;

if(!id){
    Astro.redirect('/');
}

const res = await fetch(`https://api.spacexdata.com/v4/launches/${id}`);
const launch = (await res.json()) as Doc;

// export async function getStaticPaths() {
//     const res = await fetch('https://api.spacexdata.com/v4/launches/query', {
//         method: 'POST',
//         headers: {
//             'Content-Type': 'application/json',
//         },
//         body: JSON.stringify({
//         query: {},
//         options: {
//             limit: 10,
//             sort: {
//                 date_unix: 'asc',
//                 },
//             },
//         }),
//     });

//     const data = await res.json();
//     const paths = data.docs.map((launch: any) => ({
//         params: { id: launch.id }
//     }));

//     return paths;
// }
---

<Layout title=`Launch ${launch?.id}`>
    <article class="flex flex-col gap-y-4">
        <img src={launch?.links?.patch.small} alt={`Patch for launch ${launch?.name}`} class="w-52 h-auto" />
        <h2 class="text-4xl text-white font-bold">Launch #{launch?.flight_number}</h2>
        <p class="text-lg">{launch?.details}</p>
    </article>
</Layout>